<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carmen.NET Security Architecture - Carmen.NET Documentation</title>
    <link rel="stylesheet" href="/public/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #212121;
            background: #f5f5f5;
            padding: 0;
            margin: 0;
        }
        .doc-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .doc-header {
            border-bottom: 2px solid #1976D2;
            padding-bottom: 16px;
            margin-bottom: 32px;
        }
        .doc-header h1 {
            margin: 0;
            color: #1976D2;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #1976D2;
            text-decoration: none;
            margin-bottom: 16px;
            font-weight: 600;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .doc-content h1 {
            font-size: 2.5em;
            margin-top: 0;
            margin-bottom: 0.5em;
            color: #1f2937;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.3em;
        }
        .doc-content h2 {
            font-size: 2em;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: #1f2937;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.3em;
        }
        .doc-content h3 {
            font-size: 1.5em;
            margin-top: 1.2em;
            margin-bottom: 0.5em;
            color: #374151;
        }
        .doc-content h4 {
            font-size: 1.25em;
            margin-top: 1em;
            margin-bottom: 0.5em;
            color: #4b5563;
        }
        .doc-content p {
            line-height: 1.7;
            margin-bottom: 1em;
            color: #374151;
        }
        .doc-content ul, .doc-content ol {
            margin-bottom: 1em;
            padding-left: 2em;
        }
        .doc-content li {
            margin-bottom: 0.5em;
            line-height: 1.7;
        }
        .doc-content code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #e11d48;
        }
        .doc-content pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1em;
        }
        .doc-content pre code {
            background: none;
            padding: 0;
            color: #f9fafb;
        }
        .doc-content table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1em;
        }
        .doc-content th, .doc-content td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: left;
        }
        .doc-content th {
            background: #f9fafb;
            font-weight: 600;
        }
        .doc-content blockquote {
            border-left: 4px solid #3b82f6;
            padding-left: 16px;
            margin-left: 0;
            color: #6b7280;
            font-style: italic;
        }
        .doc-content a {
            color: #3b82f6;
            text-decoration: none;
        }
        .doc-content a:hover {
            text-decoration: underline;
        }
        .doc-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1em 0;
        }
        .mermaid {
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin: 1em 0;
            text-align: center;
            overflow-x: auto;
        }
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        @media (max-width: 768px) {
            .doc-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="doc-container">
        <a href="/public/index.html" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Back to Documentation
        </a>
        <div class="doc-header">
            <h1>Carmen.NET Security Architecture</h1>
        </div>
        <div class="doc-content">
            <h1>Carmen.NET Security Architecture</h1>
<p><strong>Document Version</strong>: 1.0<br><strong>Last Updated</strong>: 2025-10-06<br><strong>Status</strong>: Phase 2 Analysis</p>
<hr>
<h2>Executive Summary</h2>
<p>Carmen.NET implements a comprehensive multi-layered security architecture with role-based access control (RBAC), multi-tenant isolation, and token-based authentication across all 351+ API endpoints.</p>
<hr>
<h2>1. Authentication Architecture</h2>
<h3>1.1 Authentication Flow</h3>
<div class="mermaid">sequenceDiagram
    participant Client
    participant LoginController
    participant TokenController
    participant Database

    Client->>LoginController: Login Request
    LoginController->>Database: Verify User
    LoginController->>TokenController: Generate JWT
    TokenController-->>Client: Return Token
    Note over Client: Client Stores Token</div><h3>1.2 Authentication Components</h3>
<p><strong>Login Endpoint</strong>: <code>/api/login</code> (LoginController)</p>
<ul>
<li>Accepts: Username, Password</li>
<li>Returns: Authentication token (JWT inferred)</li>
<li>Method: POST</li>
<li>Order: 0 (highest priority in Swagger)</li>
</ul>
<p><strong>Token Management</strong>: TokenController</p>
<ul>
<li>Token generation</li>
<li>Token validation</li>
<li>Token refresh (inferred)</li>
<li>Order: 4 in Swagger</li>
</ul>
<h3>1.3 Authentication Pattern</h3>
<pre><code class="language-csharp">[HttpPost]
[Route(&quot;api/login&quot;)]
public async Task&lt;IHttpActionResult&gt; Login(LoginRequest request)
{
    // 1. Validate credentials
    // 2. Generate token
    // 3. Return token to client
}</code></pre><p><strong>All Endpoints Protected</strong>:</p>
<pre><code class="language-csharp">[Authorize]  // Applied to all controllers
[Route(&quot;api/...&quot;)]
public async Task&lt;IHttpActionResult&gt; SomeMethod()
{
    // Authorization verified before execution
}</code></pre><hr>
<h2>2. Authorization Architecture</h2>
<h3>2.1 Role-Based Access Control (RBAC)</h3>
<p><strong>Permission Model</strong>:</p>
<ul>
<li>Permission format: <code>{Module}.{Entity}</code> (e.g., &quot;AP.Invoice&quot;, &quot;AR.Receipt&quot;)</li>
<li>Actions: View, Create, Update, Delete, Approve, Post, Close</li>
<li>Granular per-endpoint permission checks</li>
</ul>
<h3>2.2 Permission Check Pattern</h3>
<p><strong>Standard Pattern in All Controllers</strong>:</p>
<pre><code class="language-csharp">var permission = await FncPermission.GetPermissionInfoByPermissionNameAsync(&quot;AP.Invoice&quot;);

if (!permission.View)
    return this.JsonResultForbidden(&quot;&quot;, &quot;AP.Invoice&quot;, &quot;View&quot;);

if (!permission.Create)
    return this.JsonResultForbidden(&quot;&quot;, &quot;AP.Invoice&quot;, &quot;Create&quot;);

if (!permission.Approve)
    return this.JsonResultForbidden(&quot;&quot;, &quot;AP.Invoice&quot;, &quot;Approve&quot;);</code></pre><h3>2.3 Permission Matrix (Examples from Analysis)</h3>
<table>
<thead>
<tr>
<th>Module</th>
<th>Entity</th>
<th>Permission String</th>
<th>Controllers Using</th>
</tr>
</thead>
<tbody><tr>
<td><strong>AP</strong></td>
<td>Invoice</td>
<td><code>AP.Invoice</code></td>
<td>ApInvoiceController</td>
</tr>
<tr>
<td><strong>AP</strong></td>
<td>Payment</td>
<td><code>AP.Payment</code></td>
<td>ApPaymentController</td>
</tr>
<tr>
<td><strong>AP</strong></td>
<td>WHT</td>
<td><code>AP.WHT</code></td>
<td>ApWhtController</td>
</tr>
<tr>
<td><strong>AR</strong></td>
<td>Invoice</td>
<td><code>AR.Invoice</code></td>
<td>ArInvoiceController</td>
</tr>
<tr>
<td><strong>AR</strong></td>
<td>Receipt</td>
<td><code>AR.Receipt</code></td>
<td>ArReceiptController</td>
</tr>
<tr>
<td><strong>GL</strong></td>
<td>Journal</td>
<td><code>GL.Journal</code></td>
<td>GlJvController</td>
</tr>
<tr>
<td><strong>GL</strong></td>
<td>Period</td>
<td><code>GL.Period</code></td>
<td>GlPeriodController</td>
</tr>
<tr>
<td><strong>Asset</strong></td>
<td>Register</td>
<td><code>Asset.Register</code></td>
<td>AssetRegisterController</td>
</tr>
</tbody></table>
<p><strong>Unique Permissions Identified</strong>: Extracted from 60 controllers</p>
<hr>
<h2>3. Multi-Tenant Security</h2>
<h3>3.1 Tenant Isolation</h3>
<p><strong>Tenant Context Pattern</strong> (found in all controllers):</p>
<pre><code class="language-csharp">FncBase.ApplyTenantIfUseTenant(useTenant);</code></pre><p><strong>Tenant Management</strong>:</p>
<ul>
<li>TenantController (Order: 5)</li>
<li>UserTenantController (Order: 6, 15 endpoints)</li>
<li>Tenant-specific data segregation</li>
</ul>
<h3>3.2 Tenant Isolation Mechanisms</h3>
<p><strong>Database Level</strong>:</p>
<ul>
<li>Inferred: Tenant-specific connection strings or schema isolation</li>
<li>Multi-tenant database architecture (from analysis)</li>
</ul>
<p><strong>Application Level</strong>:</p>
<ul>
<li>Tenant context applied to ALL API calls</li>
<li><code>useTenant</code> parameter in controller methods</li>
<li>Tenant validation before data access</li>
</ul>
<p><strong>User-Tenant Mapping</strong>:</p>
<ul>
<li>Users can belong to multiple tenants</li>
<li>UserTenantController manages assignments (15 endpoints)</li>
</ul>
<h3>3.3 Data Segregation</h3>
<div class="mermaid">flowchart TD
    A[User Request<br/>+ Auth Token] --> B[Extract Tenant Context<br/>from Token/Parameter]
    B --> C[Apply Tenant Filter<br/>to ALL Database Queries]
    C --> D[Return ONLY Tenant<br/>Specific Data]

    style A fill:#e3f2fd,stroke:#1976d2
    style B fill:#fff3e0,stroke:#f57c00
    style C fill:#e8f5e9,stroke:#388e3c
    style D fill:#f3e5f5,stroke:#7b1fa2</div><hr>
<h2>4. API Security</h2>
<h3>4.1 Endpoint Protection</h3>
<p><strong>All 351+ Endpoints Protected</strong>:</p>
<ul>
<li><code>[Authorize]</code> attribute on all controllers</li>
<li>Permission checks per operation</li>
<li>Error responses don&#39;t leak sensitive information</li>
</ul>
<h3>4.2 Security Headers (Inferred)</h3>
<p><strong>BaseApiController</strong> (858 lines):</p>
<ul>
<li>Centralized error handling</li>
<li>Standardized JSON responses</li>
<li>Security utilities</li>
</ul>
<p><strong>Response Patterns</strong>:</p>
<pre><code class="language-csharp">// Success
return this.JsonResultOk(data);

// Forbidden (permission denied)
return this.JsonResultForbidden(message, module, action);

// Error (no sensitive data)
return this.JsonResultInternalError(exception);</code></pre><h3>4.3 Input Validation</h3>
<p><strong>Model Validation</strong> (597 model files):</p>
<ul>
<li>Data type validation via models</li>
<li>Required fields enforced</li>
<li>Length restrictions</li>
</ul>
<p><strong>Parameter Models</strong>:</p>
<ul>
<li>104 <code>Param*</code> models for request validation</li>
<li>Input sanitization (inferred)</li>
</ul>
<hr>
<h2>5. Data Security</h2>
<h3>5.1 Encryption Services</h3>
<p><strong>Carmen.Crypto Project</strong>:</p>
<ul>
<li>Encryption library</li>
<li>Decryption library</li>
<li>Data at rest encryption (inferred)</li>
</ul>
<p><strong>Usage Pattern</strong> (inferred):</p>
<pre><code class="language-csharp">// Sensitive data encryption
var encrypted = CryptoService.Encrypt(sensitiveData);

// Decryption when needed
var decrypted = CryptoService.Decrypt(encryptedData);</code></pre><h3>5.2 Sensitive Data Protection</h3>
<p><strong>Identified Sensitive Data</strong>:</p>
<ul>
<li>Vendor tax IDs</li>
<li>Customer financial information</li>
<li>User credentials (hashed)</li>
<li>Payment information</li>
<li>Banking details</li>
</ul>
<p><strong>Protection Mechanisms</strong>:</p>
<ul>
<li>Encryption at rest (Carmen.Crypto)</li>
<li>Secure transmission (HTTPS)</li>
<li>No passwords in View models (ViewUserNoPassword)</li>
</ul>
<hr>
<h2>6. Session &amp; Token Management</h2>
<h3>6.1 Token-Based Authentication</h3>
<p><strong>Token Controller</strong> (Order: 4):</p>
<ul>
<li>Token generation</li>
<li>Token validation</li>
<li>Token lifecycle management</li>
</ul>
<h3>6.2 Session Security</h3>
<p><strong>Characteristics</strong> (inferred):</p>
<ul>
<li>Stateless API (JWT tokens)</li>
<li>Token expiration</li>
<li>Token refresh mechanism</li>
<li>No server-side session storage</li>
</ul>
<hr>
<h2>7. Workflow &amp; Approval Security</h2>
<h3>7.1 Workflow Security</h3>
<p><strong>WorkflowController</strong> (12 endpoints, Order: 2):</p>
<ul>
<li>Approval workflows</li>
<li>Status-based access control</li>
<li>Workflow state validation</li>
</ul>
<h3>7.2 Approval Permissions</h3>
<p><strong>Workflow Modules</strong>:</p>
<ul>
<li><code>AP_VENDOR</code>: Vendor approval workflow</li>
<li><code>AP_INVOICE</code>: Invoice approval workflow</li>
<li><code>AP_PAYMENT</code>: Payment approval workflow</li>
<li><code>AR_INVOICE</code>: AR invoice approval</li>
<li><code>AR_RECEIPT</code>: Receipt approval</li>
</ul>
<p><strong>Approval Pattern</strong>:</p>
<pre><code class="language-csharp">// Only users with Approve permission can approve
if (!permission.Approve)
    return Forbidden();

// Workflow state validation
if (entity.Status != Status.PendingApproval)
    return InvalidState();</code></pre><hr>
<h2>8. Audit &amp; Logging</h2>
<h3>8.1 Process Logging</h3>
<p><strong>ProcessLogController</strong> (Order: 1020):</p>
<ul>
<li>2 endpoints for log management</li>
<li>Action logging (<code>EnumLogAction</code>)</li>
</ul>
<h3>8.2 Audit Trail</h3>
<p><strong>Components</strong>:</p>
<ul>
<li>User action logging</li>
<li>Permission check logging</li>
<li>Error logging (all controllers)</li>
</ul>
<p><strong>Logging Pattern</strong> (found in all controllers):</p>
<pre><code class="language-csharp">try {
    LogHttpRequest.Info($&quot;{this.GetType().Name} : {methodName}&quot;);
    // ... business logic ...
} catch (Exception e) {
    LogHttpResult.Error(e);
    return this.JsonResultInternalError(e);
}</code></pre><hr>
<h2>9. Security Best Practices Observed</h2>
<h3>9.1 ✅ Implemented</h3>
<ol>
<li><p><strong>Authentication</strong></p>
<ul>
<li>✅ Token-based authentication</li>
<li>✅ All endpoints require authentication</li>
<li>✅ Centralized login mechanism</li>
</ul>
</li>
<li><p><strong>Authorization</strong></p>
<ul>
<li>✅ RBAC implementation</li>
<li>✅ Granular permissions per module/entity</li>
<li>✅ Permission checks before data access</li>
</ul>
</li>
<li><p><strong>Multi-Tenancy</strong></p>
<ul>
<li>✅ Tenant context isolation</li>
<li>✅ User-tenant mapping</li>
<li>✅ Data segregation</li>
</ul>
</li>
<li><p><strong>API Security</strong></p>
<ul>
<li>✅ Standardized error responses</li>
<li>✅ Input validation via models</li>
<li>✅ No sensitive data in error messages</li>
</ul>
</li>
<li><p><strong>Data Protection</strong></p>
<ul>
<li>✅ Encryption library (Carmen.Crypto)</li>
<li>✅ Sensitive data handling</li>
<li>✅ Password excluded from view models</li>
</ul>
</li>
<li><p><strong>Audit</strong></p>
<ul>
<li>✅ Request/response logging</li>
<li>✅ Error logging</li>
<li>✅ Action tracking</li>
</ul>
</li>
</ol>
<h3>9.2 ⚠️ Recommendations</h3>
<ol>
<li><p><strong>Enhanced Security</strong></p>
<ul>
<li>⚠️ Implement rate limiting</li>
<li>⚠️ Add API throttling</li>
<li>⚠️ Implement CORS policies</li>
<li>⚠️ Add request signing for critical operations</li>
</ul>
</li>
<li><p><strong>Token Security</strong></p>
<ul>
<li>⚠️ Implement token rotation</li>
<li>⚠️ Add token revocation</li>
<li>⚠️ Monitor token usage patterns</li>
</ul>
</li>
<li><p><strong>Advanced Protection</strong></p>
<ul>
<li>⚠️ Add SQL injection protection verification</li>
<li>⚠️ Implement XSS protection</li>
<li>⚠️ Add CSRF tokens for state-changing operations</li>
<li>⚠️ Implement content security policy (CSP)</li>
</ul>
</li>
<li><p><strong>Monitoring</strong></p>
<ul>
<li>⚠️ Add intrusion detection</li>
<li>⚠️ Implement anomaly detection</li>
<li>⚠️ Add security event monitoring</li>
<li>⚠️ Create security dashboard</li>
</ul>
</li>
</ol>
<hr>
<h2>10. Security Architecture Diagram</h2>
<div class="mermaid">graph TD
    Client["CLIENT LAYER<br/>━━━━━━━━━━━━━━━━━━━━━━━━━━━<br/>• Web Browser HTTPS<br/>• Excel Add-in HTTPS"]

    subgraph Auth["AUTHENTICATION LAYER"]
        Login[LoginController<br/>Verify User]
        Token[TokenController<br/>Issue Token]
        Login --> Token
    end

    subgraph Authz["AUTHORIZATION LAYER"]
        Authorize["[Authorize] Attribute<br/>Applied to ALL Controllers"]
        Permission["Permission Checks<br/>FncPermission.Check module.action"]
        Authorize --> Permission
    end

    subgraph Tenant["MULTI-TENANT ISOLATION LAYER"]
        TenantCtx["FncBase.ApplyTenantIfUseTenant<br/>Tenant Context Applied to ALL Ops"]
    end

    subgraph API["API LAYER - 60 Controllers"]
        AP["AP Module<br/>7 controllers"]
        AR["AR Module<br/>9 controllers"]
        GL["GL Module<br/>5 controllers"]
        Asset["Asset Module<br/>6 controllers"]
        Income["Income Module<br/>5 controllers"]
        Admin["System Admin<br/>15+ controllers"]
        Logging["All controllers log<br/>requests & errors"]
    end

    subgraph Crypto["DATA ENCRYPTION LAYER"]
        CarmenCrypto["Carmen.Crypto<br/>• Encrypt sensitive data<br/>• Decrypt on retrieval"]
    end

    DB["DATABASE LAYER<br/>━━━━━━━━━━━━━━━━━━━━━━━━━━━<br/>• Tenant-isolated data<br/>• Encrypted sensitive fields<br/>• Audit trail tables"]

    Client --> Auth
    Auth --> Authz
    Authz --> Tenant
    Tenant --> API
    API --> Crypto
    Crypto --> DB

    style Client fill:#e3f2fd,stroke:#1976d2,color:#000000
    style Auth fill:#fff3e0,stroke:#f57c00,color:#000000
    style Authz fill:#e8f5e9,stroke:#388e3c,color:#000000
    style Tenant fill:#f3e5f5,stroke:#7b1fa2,color:#000000
    style API fill:#fce4ec,stroke:#c2185b,color:#000000
    style Crypto fill:#e0f2f1,stroke:#00796b,color:#000000
    style DB fill:#ffebee,stroke:#d32f2f,color:#000000</div><hr>
<h2>11. Compliance &amp; Standards</h2>
<h3>11.1 Security Standards Alignment</h3>
<p><strong>OWASP Top 10 Coverage</strong>:</p>
<ul>
<li>✅ A01: Broken Access Control → RBAC + Permission checks</li>
<li>✅ A02: Cryptographic Failures → Carmen.Crypto encryption</li>
<li>✅ A03: Injection → Model validation + parameterized queries (inferred)</li>
<li>✅ A07: Identification/Authentication → Token-based auth</li>
<li>✅ A08: Software &amp; Data Integrity → Logging + audit trail</li>
</ul>
<h3>11.2 Compliance Considerations</h3>
<p><strong>GDPR Readiness</strong>:</p>
<ul>
<li>✅ User consent management (inferred)</li>
<li>✅ Data encryption</li>
<li>✅ Audit logging</li>
<li>⚠️ Need: Data retention policies</li>
<li>⚠️ Need: Right to be forgotten implementation</li>
</ul>
<p><strong>SOC 2 Alignment</strong>:</p>
<ul>
<li>✅ Access controls</li>
<li>✅ Audit logging</li>
<li>✅ Encryption</li>
<li>⚠️ Need: Enhanced monitoring</li>
</ul>
<hr>
<h2>12. Security Metrics</h2>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Value</th>
<th>Status</th>
</tr>
</thead>
<tbody><tr>
<td>Protected Endpoints</td>
<td>351+</td>
<td>✅ 100%</td>
</tr>
<tr>
<td>Controllers with <code>[Authorize]</code></td>
<td>60</td>
<td>✅ 100%</td>
</tr>
<tr>
<td>Permission Checks</td>
<td>Per endpoint</td>
<td>✅ Comprehensive</td>
</tr>
<tr>
<td>Multi-tenant Isolation</td>
<td>All controllers</td>
<td>✅ Enforced</td>
</tr>
<tr>
<td>Error Logging</td>
<td>All controllers</td>
<td>✅ Implemented</td>
</tr>
<tr>
<td>Encryption Library</td>
<td>Carmen.Crypto</td>
<td>✅ Available</td>
</tr>
</tbody></table>
<hr>
<h2>13. Security Incident Response</h2>
<h3>13.1 Detection Mechanisms</h3>
<p><strong>Logging</strong>:</p>
<ul>
<li>All HTTP requests logged</li>
<li>All errors logged</li>
<li>All permission denials logged</li>
</ul>
<h3>13.2 Response Procedures (Recommended)</h3>
<ol>
<li><strong>Detection</strong> → Review ProcessLog and error logs</li>
<li><strong>Analysis</strong> → Identify attack pattern</li>
<li><strong>Containment</strong> → Disable compromised accounts</li>
<li><strong>Eradication</strong> → Fix vulnerability</li>
<li><strong>Recovery</strong> → Restore normal operations</li>
<li><strong>Lessons Learned</strong> → Update security policies</li>
</ol>
<hr>
<h2>Conclusion</h2>
<p>Carmen.NET implements a <strong>comprehensive, multi-layered security architecture</strong> with:</p>
<p>✅ <strong>Strong Authentication</strong> - Token-based with centralized management<br>✅ <strong>Granular Authorization</strong> - RBAC with per-endpoint permission checks<br>✅ <strong>Multi-Tenant Isolation</strong> - Tenant context enforced across all operations<br>✅ <strong>API Security</strong> - All 351+ endpoints protected with standardized error handling<br>✅ <strong>Data Encryption</strong> - Dedicated crypto library for sensitive data<br>✅ <strong>Audit Trail</strong> - Comprehensive logging of all operations</p>
<p><strong>Security Posture</strong>: <strong>STRONG</strong> with room for enhancements in rate limiting, advanced monitoring, and compliance automation.</p>
<hr>
<p><strong>Document Generated</strong>: 2025-10-06<br><strong>Analysis Phase</strong>: Phase 2 - Architecture &amp; Data Modeling<br><strong>Next</strong>: Integration Architecture Documentation</p>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
        });

        // Render all mermaid diagrams
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidElements = document.querySelectorAll('.mermaid');
            console.log('Found ' + mermaidElements.length + ' mermaid diagrams');

            mermaidElements.forEach((element, index) => {
                element.id = 'mermaid-' + index;
            });

            if (mermaidElements.length > 0) {
                mermaid.run();
            }
        });
    </script>
</body>
</html>