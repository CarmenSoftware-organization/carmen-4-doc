<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Receipt Workflow - Carmen.NET Documentation</title>
    <link rel="stylesheet" href="/public/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #212121;
            background: #f5f5f5;
            padding: 0;
            margin: 0;
        }
        .doc-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .doc-header {
            border-bottom: 2px solid #1976D2;
            padding-bottom: 16px;
            margin-bottom: 32px;
        }
        .doc-header h1 {
            margin: 0;
            color: #1976D2;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #1976D2;
            text-decoration: none;
            margin-bottom: 16px;
            font-weight: 600;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .doc-content h1 {
            font-size: 2.5em;
            margin-top: 0;
            margin-bottom: 0.5em;
            color: #1f2937;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.3em;
        }
        .doc-content h2 {
            font-size: 2em;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: #1f2937;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.3em;
        }
        .doc-content h3 {
            font-size: 1.5em;
            margin-top: 1.2em;
            margin-bottom: 0.5em;
            color: #374151;
        }
        .doc-content h4 {
            font-size: 1.25em;
            margin-top: 1em;
            margin-bottom: 0.5em;
            color: #4b5563;
        }
        .doc-content p {
            line-height: 1.7;
            margin-bottom: 1em;
            color: #374151;
        }
        .doc-content ul, .doc-content ol {
            margin-bottom: 1em;
            padding-left: 2em;
        }
        .doc-content li {
            margin-bottom: 0.5em;
            line-height: 1.7;
        }
        .doc-content code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #e11d48;
        }
        .doc-content pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1em;
        }
        .doc-content pre code {
            background: none;
            padding: 0;
            color: #f9fafb;
        }
        .doc-content table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1em;
        }
        .doc-content th, .doc-content td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: left;
        }
        .doc-content th {
            background: #f9fafb;
            font-weight: 600;
        }
        .doc-content blockquote {
            border-left: 4px solid #3b82f6;
            padding-left: 16px;
            margin-left: 0;
            color: #6b7280;
            font-style: italic;
        }
        .doc-content a {
            color: #3b82f6;
            text-decoration: none;
        }
        .doc-content a:hover {
            text-decoration: underline;
        }
        .doc-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1em 0;
        }
        .mermaid {
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin: 1em 0;
            text-align: center;
            overflow-x: auto;
        }
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        @media (max-width: 768px) {
            .doc-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="doc-container">
        <a href="/public/index.html" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Back to Documentation
        </a>
        <div class="doc-header">
            <h1>AR Receipt Workflow</h1>
        </div>
        <div class="doc-content">
            <h1>AR Receipt Workflow</h1>
<h2>Overview</h2>
<p>The AR Receipt workflow manages the customer payment receipt process from payment collection through bank deposit reconciliation, including receipt approval workflows and GL posting.</p>
<h2>Workflow States</h2>
<div class="mermaid">stateDiagram-v2
    [*] --> Draft
    Draft --> PendingApproval: Submit for Approval
    Draft --> Draft: Save
    Draft --> Cancelled: Cancel

    PendingApproval --> Approved: Approve
    PendingApproval --> Rejected: Reject
    PendingApproval --> Draft: Return for Revision

    Rejected --> Draft: Revise
    Rejected --> Cancelled: Cancel

    Approved --> Posted: Post to GL

    Posted --> Deposited: Bank Deposit
    Posted --> Bounced: Check Bounced

    Deposited --> Cleared: Bank Reconciliation
    Deposited --> Bounced: Check Bounced After Deposit

    Bounced --> Posted: Redeposit
    Bounced --> WrittenOff: Write-off

    Cleared --> [*]
    WrittenOff --> [*]
    Cancelled --> [*]</div><h2>Status Codes</h2>
<table>
<thead>
<tr>
<th>Status</th>
<th>Value</th>
<th>Description</th>
<th>Allowed Actions</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Draft</strong></td>
<td>0</td>
<td>Initial creation, data entry in progress</td>
<td>Edit, Submit, Delete, Cancel</td>
</tr>
<tr>
<td><strong>Pending Approval</strong></td>
<td>2</td>
<td>Submitted for approval</td>
<td>Approve, Reject, Return</td>
</tr>
<tr>
<td><strong>Approved</strong></td>
<td>3</td>
<td>Approved by authorized user</td>
<td>Post to GL, Deposit</td>
</tr>
<tr>
<td><strong>Rejected</strong></td>
<td>4</td>
<td>Rejected during approval</td>
<td>Revise, Cancel</td>
</tr>
<tr>
<td><strong>Posted</strong></td>
<td>1</td>
<td>Posted to General Ledger</td>
<td>Deposit, Mark Bounced</td>
</tr>
<tr>
<td><strong>Deposited</strong></td>
<td>5</td>
<td>Deposited to bank</td>
<td>Clear, Mark Bounced</td>
</tr>
<tr>
<td><strong>Cleared</strong></td>
<td>6</td>
<td>Reconciled with bank statement</td>
<td>View Only</td>
</tr>
<tr>
<td><strong>Bounced</strong></td>
<td>7</td>
<td>Check/payment bounced</td>
<td>Redeposit, Write-off</td>
</tr>
<tr>
<td><strong>Written Off</strong></td>
<td>8</td>
<td>Bad debt written off</td>
<td>View Only</td>
</tr>
<tr>
<td><strong>Cancelled</strong></td>
<td>9</td>
<td>Cancelled before posting</td>
<td>View Only</td>
</tr>
</tbody></table>
<h2>Workflow Diagram</h2>
<div class="mermaid">flowchart TD
    Start([Start: Receive Payment]) --> SelectPaymentMethod{Payment<br/>Method?}

    SelectPaymentMethod -->|Cash| EnterCash[Enter Cash Details]
    SelectPaymentMethod -->|Check| EnterCheck[Enter Check Details]
    SelectPaymentMethod -->|Wire| EnterWire[Enter Wire Transfer Details]
    SelectPaymentMethod -->|Credit Card| EnterCard[Enter Card Details]

    EnterCash --> SelectInvoices
    EnterCheck --> SelectInvoices
    EnterWire --> SelectInvoices
    EnterCard --> SelectInvoices

    SelectInvoices[Select Invoices to Apply] --> ValidateInvoices{Invoices<br/>Valid?}

    ValidateInvoices -->|No| ShowErrors[Show Validation Errors]
    ShowErrors --> SelectInvoices

    ValidateInvoices -->|Yes| ApplyPayment[Apply Payment to Invoices]
    ApplyPayment --> CalculateBalance{Payment<br/>Applied?}

    CalculateBalance -->|Exact Match| AllApplied[All Payment Applied]
    CalculateBalance -->|Overpayment| CreateCredit[Create Customer Credit]
    CalculateBalance -->|Underpayment| PartialApply[Partial Application]

    AllApplied --> ValidateReceipt
    CreateCredit --> ValidateReceipt
    PartialApply --> ValidateReceipt

    ValidateReceipt{Validation<br/>Passed?} -->|No| ShowReceiptErrors[Show Validation Errors]
    ShowReceiptErrors --> SelectInvoices

    ValidateReceipt -->|Yes| SaveDraft[Save as Draft<br/>Status = 0]
    SaveDraft --> CheckSubmit{User Action?}

    CheckSubmit -->|Save| SaveDraft
    CheckSubmit -->|Submit| CheckPermission{Has Submit<br/>Permission?}
    CheckSubmit -->|Cancel| CancelReceipt[Cancel Receipt<br/>Status = 9]

    CheckPermission -->|No| Forbidden[Permission Denied]
    CheckPermission -->|Yes| SubmitApproval[Submit for Approval<br/>Status = 2]

    SubmitApproval --> NotifyApprover[Notify Approver]
    NotifyApprover --> WaitApproval[Wait for Approval]

    WaitApproval --> ApproverAction{Approver<br/>Decision?}

    ApproverAction -->|Approve| CheckApprovePermission{Has Approve<br/>Permission?}
    ApproverAction -->|Reject| RejectReceipt[Reject Receipt<br/>Status = 4]
    ApproverAction -->|Return| ReturnDraft[Return to Draft<br/>Status = 0]

    CheckApprovePermission -->|No| Forbidden
    CheckApprovePermission -->|Yes| ApproveReceipt[Approve Receipt<br/>Status = 3]

    ApproveReceipt --> ReadyPost[Ready for GL Posting]
    ReadyPost --> PostAction{User Action?}

    PostAction -->|Post to GL| CheckPostPermission{Has Post<br/>Permission?}

    CheckPostPermission -->|No| Forbidden
    CheckPostPermission -->|Yes| ValidateAccounts{GL Accounts<br/>Valid?}

    ValidateAccounts -->|No| ShowAccountError[Show Account Errors]
    ValidateAccounts -->|Yes| CreateGLJV[Create GL Journal Voucher]

    CreateGLJV --> PostGLEntries[Post GL Entries:<br/>DR: Bank/Cash Account<br/>CR: AR Receivable<br/>DR/CR: Discount if applicable]

    PostGLEntries --> UpdateInvoices[Update Invoice Status<br/>to Paid/Partially Paid]
    UpdateInvoices --> UpdateStatus[Update Receipt Status<br/>Status = 1 Posted]

    UpdateStatus --> GenerateReceipt[Generate Receipt Document]
    GenerateReceipt --> WaitDeposit[Wait for Bank Deposit]

    WaitDeposit --> DepositAction{Deposit<br/>Action?}

    DepositAction -->|Deposit| MarkDeposited[Mark as Deposited<br/>Status = 5]
    DepositAction -->|Bounced| MarkBounced[Mark as Bounced<br/>Status = 7]

    MarkDeposited --> WaitClearing[Wait for Bank Reconciliation]

    WaitClearing --> BankAction{Bank<br/>Action?}

    BankAction -->|Reconcile| MarkCleared[Mark as Cleared<br/>Status = 6]
    BankAction -->|Bounced| MarkBounced

    MarkBounced --> ReverseGL[Reverse GL Entries]
    ReverseGL --> RevertInvoices[Revert Invoice Status]
    RevertInvoices --> BouncedDecision{Resolution?}

    BouncedDecision -->|Redeposit| EnterCheck
    BouncedDecision -->|Write-off| WriteOff[Write-off<br/>Status = 8]

    MarkCleared --> End([End])
    WriteOff --> End
    CancelReceipt --> End
    RejectReceipt --> End</div><h2>Business Rules</h2>
<h3>Validation Rules</h3>
<ol>
<li><p><strong>Required Fields</strong>:</p>
<ul>
<li>Receipt Date</li>
<li>Receipt Number</li>
<li>Customer Code</li>
<li>Payment Method</li>
<li>Payment Amount &gt; 0</li>
<li>Bank Account (for non-cash payments)</li>
<li>At least one invoice selected</li>
</ul>
</li>
<li><p><strong>Business Rules</strong>:</p>
<ul>
<li>Receipt Date cannot be in the future</li>
<li>Customer must be active</li>
<li>GL Period must be open for receipt date</li>
<li>Selected invoices must be posted (Status = 1, 5)</li>
<li>Total applied amount cannot exceed payment amount</li>
<li>Check number must be unique (per customer)</li>
<li>Duplicate receipt numbers not allowed</li>
</ul>
</li>
<li><p><strong>Payment Application Rules</strong>:</p>
<ul>
<li>Applied Amount &lt;= Invoice Outstanding Balance</li>
<li>Earliest invoices applied first (FIFO) by default</li>
<li>Manual application override allowed</li>
<li>Overpayment creates customer credit balance</li>
<li>Payment discount validation if applicable</li>
</ul>
</li>
</ol>
<h3>Permission Requirements</h3>
<table>
<thead>
<tr>
<th>Action</th>
<th>Permission</th>
<th>Permission Code</th>
</tr>
</thead>
<tbody><tr>
<td><strong>View</strong></td>
<td>View permission</td>
<td><code>AR.Receipt.View</code></td>
</tr>
<tr>
<td><strong>Create</strong></td>
<td>Create permission</td>
<td><code>AR.Receipt.Create</code></td>
</tr>
<tr>
<td><strong>Update</strong></td>
<td>Update permission</td>
<td><code>AR.Receipt.Update</code></td>
</tr>
<tr>
<td><strong>Delete</strong></td>
<td>Delete permission</td>
<td><code>AR.Receipt.Delete</code></td>
</tr>
<tr>
<td><strong>Submit</strong></td>
<td>Create permission</td>
<td><code>AR.Receipt.Create</code></td>
</tr>
<tr>
<td><strong>Approve</strong></td>
<td>Approve permission</td>
<td><code>AR.Receipt.Approve</code></td>
</tr>
<tr>
<td><strong>Reject</strong></td>
<td>Approve permission</td>
<td><code>AR.Receipt.Approve</code></td>
</tr>
<tr>
<td><strong>Post</strong></td>
<td>Post permission</td>
<td><code>AR.Receipt.Post</code></td>
</tr>
<tr>
<td><strong>Deposit</strong></td>
<td>Deposit permission</td>
<td><code>AR.Receipt.Deposit</code></td>
</tr>
<tr>
<td><strong>Reconcile</strong></td>
<td>Reconcile permission</td>
<td><code>AR.Receipt.Reconcile</code></td>
</tr>
</tbody></table>
<h3>Payment Methods</h3>
<h4>Cash Receipt</h4>
<ul>
<li>Physical cash collection</li>
<li>Petty cash integration</li>
<li>Daily cash reconciliation</li>
<li>Cash deposit slip generation</li>
</ul>
<h4>Check Receipt</h4>
<ul>
<li>Check number recording</li>
<li>Check date validation</li>
<li>Bank and branch details</li>
<li>Post-dated check handling</li>
<li>Check bounce management</li>
</ul>
<h4>Wire Transfer</h4>
<ul>
<li>Bank reference number</li>
<li>Transfer date</li>
<li>Sender bank details</li>
<li>Wire fee handling</li>
<li>International transfer support</li>
</ul>
<h4>Credit Card</h4>
<ul>
<li>Card type (Visa, Mastercard, etc.)</li>
<li>Last 4 digits (PCI compliance)</li>
<li>Authorization code</li>
<li>Merchant fees</li>
<li>Chargeback handling</li>
</ul>
<h4>Electronic Payment (ACH/EFT)</h4>
<ul>
<li>Transaction reference</li>
<li>Settlement date</li>
<li>Bank routing information</li>
<li>Payment gateway integration</li>
</ul>
<h2>Multi-Tenant Isolation</h2>
<p>All receipt operations enforce tenant isolation:</p>
<ul>
<li><code>FncBase.ApplyTenantIfUseTenant(useTenant)</code> applied to all queries</li>
<li>Users can only see receipts for their assigned tenant(s)</li>
<li>Cross-tenant data leakage prevented at database level</li>
</ul>
<h2>Approval Workflow</h2>
<h3>Approval Hierarchy</h3>
<p>Configurable approval rules based on:</p>
<ul>
<li>Receipt amount thresholds</li>
<li>Payment method</li>
<li>Customer category</li>
<li>Unusual payment patterns</li>
</ul>
<p><strong>Example Approval Matrix</strong>:</p>
<table>
<thead>
<tr>
<th>Amount Range</th>
<th>Approver Level</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td>$0 - $10,000</td>
<td>AR Clerk</td>
<td>Optional</td>
</tr>
<tr>
<td>$10,001 - $50,000</td>
<td>AR Manager</td>
<td>Required</td>
</tr>
<tr>
<td>$50,001 - $200,000</td>
<td>Finance Manager</td>
<td>Required</td>
</tr>
<tr>
<td>$200,001+</td>
<td>CFO</td>
<td>Required</td>
</tr>
</tbody></table>
<h3>Special Approval Cases</h3>
<ul>
<li>Overpayments requiring credit creation</li>
<li>Payments to write-off bad debts</li>
<li>Manual payment application overrides</li>
<li>Backdated receipts (prior period)</li>
</ul>
<h2>GL Posting</h2>
<h3>Standard Receipt Entry</h3>
<pre><code class="language-text">DR: Bank Account                           XXX.XX
CR: AR Receivable Account                 XXX.XX</code></pre><h3>Receipt with Payment Discount</h3>
<pre><code class="language-text">DR: Bank Account (net received)           XXX.XX
DR: Sales Discount Given                   XX.XX
CR: AR Receivable Account                 XXX.XX</code></pre><h3>Multiple Invoice Application</h3>
<pre><code class="language-text">DR: Bank Account                           XXX.XX
CR: AR Receivable (Invoice 1)             XXX.XX
CR: AR Receivable (Invoice 2)             XXX.XX
CR: AR Receivable (Invoice 3)             XXX.XX</code></pre><h3>Credit Card Receipt with Merchant Fee</h3>
<pre><code class="language-text">DR: Bank Account (net after fee)          XXX.XX
DR: Credit Card Merchant Fee               XX.XX
CR: AR Receivable                         XXX.XX</code></pre><h2>Payment Application Strategies</h2>
<h3>FIFO (First In, First Out)</h3>
<ul>
<li>Apply to oldest invoices first</li>
<li>Default application method</li>
<li>Reduces aged receivables</li>
</ul>
<h3>Manual Application</h3>
<ul>
<li>User selects specific invoices</li>
<li>Allows strategic application</li>
<li>Requires additional approval</li>
</ul>
<h3>Automatic Application</h3>
<ul>
<li>System matches by invoice number or reference</li>
<li>Batch processing support</li>
<li>Exception handling for mismatches</li>
</ul>
<h2>Integration Points</h2>
<h3>Upstream</h3>
<ul>
<li><strong>AR Invoice</strong>: Receipt applied to posted invoices</li>
<li><strong>Customer Master</strong>: Validates customer and payment terms</li>
<li><strong>Bank Account Master</strong>: Validates bank account</li>
<li><strong>GL Period</strong>: Validates period is open</li>
</ul>
<h3>Downstream</h3>
<ul>
<li><strong>Bank Reconciliation</strong>: Receipts cleared against bank statements</li>
<li><strong>Cash Flow Reporting</strong>: Receipt data for cash forecasting</li>
<li><strong>Customer Aging</strong>: Updates outstanding balances</li>
<li><strong>GL</strong>: Journal vouchers posted to General Ledger</li>
<li><strong>Collection Reports</strong>: Receipt history and trends</li>
</ul>
<h2>Check Bounce Handling</h2>
<h3>Bounce Detection</h3>
<ul>
<li>Bank notification of dishonored check</li>
<li>NSF (Non-Sufficient Funds)</li>
<li>Account closed</li>
<li>Stop payment</li>
<li>Signature mismatch</li>
</ul>
<h3>Bounce Process</h3>
<ol>
<li>Mark receipt as Bounced (Status = 7)</li>
<li>Create reversing GL journal voucher</li>
<li>Revert invoice payment status</li>
<li>Create bounce fee charge (optional)</li>
<li>Notify AR team and sales</li>
<li>Update customer credit status</li>
</ol>
<h3>Recovery Actions</h3>
<ul>
<li>Contact customer for replacement payment</li>
<li>Redeposit check if NSF temporary</li>
<li>Write-off if uncollectible</li>
<li>Legal action if warranted</li>
<li>Update customer risk rating</li>
</ul>
<h2>Bank Deposit Management</h2>
<h3>Deposit Process</h3>
<ol>
<li><strong>Prepare Deposit</strong>: Group receipts by bank account and date</li>
<li><strong>Generate Deposit Slip</strong>: List all checks and cash</li>
<li><strong>Physical Deposit</strong>: Take to bank</li>
<li><strong>Record Deposit</strong>: Update system with bank reference</li>
<li><strong>Mark Deposited</strong>: Change status to Deposited (Status = 5)</li>
</ol>
<h3>Deposit Reconciliation</h3>
<ul>
<li>Match deposit slip total to bank confirmation</li>
<li>Verify all items cleared</li>
<li>Investigate discrepancies</li>
<li>Handle partial clearances</li>
</ul>
<h2>Error Handling</h2>
<h3>Common Errors</h3>
<table>
<thead>
<tr>
<th>Error</th>
<th>Cause</th>
<th>Resolution</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Period Closed</strong></td>
<td>GL period is closed</td>
<td>Change receipt date or reopen period</td>
</tr>
<tr>
<td><strong>Duplicate Receipt Number</strong></td>
<td>Receipt number already used</td>
<td>Use different receipt number</td>
</tr>
<tr>
<td><strong>Invalid Bank Account</strong></td>
<td>Bank account inactive/invalid</td>
<td>Select valid bank account</td>
</tr>
<tr>
<td><strong>Invoice Already Paid</strong></td>
<td>Invoice fully paid</td>
<td>Remove invoice or adjust amount</td>
</tr>
<tr>
<td><strong>Customer Inactive</strong></td>
<td>Customer is inactive</td>
<td>Activate customer or verify customer code</td>
</tr>
<tr>
<td><strong>Permission Denied</strong></td>
<td>User lacks permission</td>
<td>Request permission from administrator</td>
</tr>
<tr>
<td><strong>Overpayment Not Allowed</strong></td>
<td>Payment exceeds invoice total</td>
<td>Enable credit creation or adjust amount</td>
</tr>
<tr>
<td><strong>Check Already Deposited</strong></td>
<td>Check number duplicate</td>
<td>Verify check number</td>
</tr>
</tbody></table>
<h2>API Endpoints</h2>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Method</th>
<th>Purpose</th>
<th>Permission</th>
</tr>
</thead>
<tbody><tr>
<td><code>/api/ar/receipt/list</code></td>
<td>GET</td>
<td>List receipts</td>
<td>View</td>
</tr>
<tr>
<td><code>/api/ar/receipt/{id}</code></td>
<td>GET</td>
<td>Get receipt details</td>
<td>View</td>
</tr>
<tr>
<td><code>/api/ar/receipt/create</code></td>
<td>POST</td>
<td>Create new receipt</td>
<td>Create</td>
</tr>
<tr>
<td><code>/api/ar/receipt/update</code></td>
<td>PUT</td>
<td>Update receipt</td>
<td>Update</td>
</tr>
<tr>
<td><code>/api/ar/receipt/delete/{id}</code></td>
<td>DELETE</td>
<td>Delete receipt</td>
<td>Delete</td>
</tr>
<tr>
<td><code>/api/ar/receipt/submit/{id}</code></td>
<td>POST</td>
<td>Submit for approval</td>
<td>Create</td>
</tr>
<tr>
<td><code>/api/ar/receipt/approve/{id}</code></td>
<td>POST</td>
<td>Approve receipt</td>
<td>Approve</td>
</tr>
<tr>
<td><code>/api/ar/receipt/reject/{id}</code></td>
<td>POST</td>
<td>Reject receipt</td>
<td>Approve</td>
</tr>
<tr>
<td><code>/api/ar/receipt/post/{id}</code></td>
<td>POST</td>
<td>Post to GL</td>
<td>Post</td>
</tr>
<tr>
<td><code>/api/ar/receipt/deposit/{id}</code></td>
<td>POST</td>
<td>Mark as deposited</td>
<td>Deposit</td>
</tr>
<tr>
<td><code>/api/ar/receipt/reconcile/{id}</code></td>
<td>POST</td>
<td>Mark as cleared</td>
<td>Reconcile</td>
</tr>
<tr>
<td><code>/api/ar/receipt/bounce/{id}</code></td>
<td>POST</td>
<td>Mark check as bounced</td>
<td>Update</td>
</tr>
<tr>
<td><code>/api/ar/receipt/print/{id}</code></td>
<td>GET</td>
<td>Print receipt</td>
<td>View</td>
</tr>
</tbody></table>
<h2>Reporting</h2>
<h3>Available Reports</h3>
<ol>
<li><strong>Receipt Register</strong>: All receipts with details</li>
<li><strong>Cash Receipt Journal</strong>: Daily/weekly/monthly cash inflows</li>
<li><strong>Bank Deposit Report</strong>: Deposits by bank and date</li>
<li><strong>Receipt by Customer</strong>: Receipt history by customer</li>
<li><strong>Payment Method Analysis</strong>: Receipts by payment method</li>
<li><strong>Undeposited Receipts</strong>: Posted but not yet deposited</li>
<li><strong>Bounced Check Report</strong>: All bounced checks with status</li>
<li><strong>Collection Effectiveness</strong>: DSO trends and collection metrics</li>
</ol>
<h2>Best Practices</h2>
<ol>
<li><p><strong>Receipt Processing</strong>:</p>
<ul>
<li>Record receipts daily for accurate cash position</li>
<li>Verify payment details before posting</li>
<li>Apply payments to correct invoices</li>
<li>Generate receipt documents for customers</li>
</ul>
</li>
<li><p><strong>Approval</strong>:</p>
<ul>
<li>Review receipts within SLA (e.g., same day)</li>
<li>Verify unusual payment patterns</li>
<li>Investigate large overpayments</li>
<li>Monitor payment method trends</li>
</ul>
</li>
<li><p><strong>Bank Deposit</strong>:</p>
<ul>
<li>Deposit checks daily to minimize bounce risk</li>
<li>Separate deposits by bank account</li>
<li>Reconcile deposit slip with bank confirmation</li>
<li>Follow up on deposit discrepancies</li>
</ul>
</li>
<li><p><strong>Bank Reconciliation</strong>:</p>
<ul>
<li>Reconcile daily receipts with bank statements</li>
<li>Clear receipts within 2 business days</li>
<li>Investigate uncleared items promptly</li>
<li>Maintain audit trail</li>
</ul>
</li>
<li><p><strong>Customer Service</strong>:</p>
<ul>
<li>Provide receipt confirmation promptly</li>
<li>Update customers on payment application</li>
<li>Handle bounced check situations professionally</li>
<li>Maintain positive customer relationships</li>
</ul>
</li>
</ol>
<hr>
<p><strong>Document Version</strong>: 1.0<br><strong>Last Updated</strong>: 2025-10-06<br><strong>Status</strong>: Phase 3 - Business Logic &amp; Workflow Analysis</p>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
        });

        // Render all mermaid diagrams
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidElements = document.querySelectorAll('.mermaid');
            console.log('Found ' + mermaidElements.length + ' mermaid diagrams');

            mermaidElements.forEach((element, index) => {
                element.id = 'mermaid-' + index;
            });

            if (mermaidElements.length > 0) {
                mermaid.run();
            }
        });
    </script>
</body>
</html>